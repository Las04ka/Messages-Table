<mat-spinner *ngIf="isLoading | async; else loaded"></mat-spinner>
<ng-template #loaded>
  <mat-card>
    <mat-card-content>
      <button
        mat-raised-button
        color="primary"
        (click)="onOpenDialog()">
        Add massage
      </button>
      <table
        mat-table
        [dataSource]="messages">
        <ng-container *ngIf="isAdding">
          <tr>
            <td colspan="4">
              <mat-spinner></mat-spinner>
            </td>
          </tr>
        </ng-container>
        <ng-container matColumnDef="id">
          <th
            mat-header-cell
            *matHeaderCellDef>
            ID
          </th>
          <td
            mat-cell
            *matCellDef="let message">
            {{ message.id.slice(0, 5) + '...' }}
          </td>
        </ng-container>
        <ng-container matColumnDef="name">
          <th
            mat-header-cell
            *matHeaderCellDef>
            Name
          </th>
          <td
            mat-cell
            *matCellDef="let message">
            {{ message.name }}
          </td>
        </ng-container>
        <ng-container matColumnDef="message">
          <th
            mat-header-cell
            *matHeaderCellDef>
            Message
          </th>
          <td
            mat-cell
            *matCellDef="let message">
            {{
              message.message.length > 100
                ? (message.message | slice : 0 : 100) + '...'
                : message.message
            }}
          </td>
        </ng-container>
        <ng-container matColumnDef="created">
          <th
            mat-header-cell
            *matHeaderCellDef>
            Created
          </th>
          <td
            mat-cell
            *matCellDef="let message">
            {{ message.created | date : 'shortTime' }}
          </td>
        </ng-container>
        <tr
          mat-header-row
          *matHeaderRowDef="displayedColumns"></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </mat-card-content>
  </mat-card>
</ng-template>
